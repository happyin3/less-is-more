# 海量评论系统

* 功能设计
* 架构设计
* 存储设计
* 可用性设计

## 前言

**架构设计重要的是对产品体系的理解**

* 不要做需求的翻译机，先理解业务背后的本子，事情的初衷。复制是没有灵魂的
* 理解背后的产品体系，搞清楚系统背后的背景，才能做出最佳的设计和抽象
    * 动机
    * 解决什么痛点
    * 给用户带来什么收益
    * 客户第一、解决客户的问题
* 架构设计最重要的就是理解整个产品体系在系统中的定位

> 技术牛逼，只是一个平面；真正牛逼的人，是一个球，要看综合能力

## 评论系统

我们往小里做就是视频评论系统，往大里做就是评论平台，可以接入各种业务形态。

* 发布评论：支持回复楼层、楼中楼
* 读取评论：按时间、热度排序
* 删除评论：用户删除、作者删除
* 管理评论：作者置顶、后台运营管理（搜索、删除、审核等）
    * 内部一些管理的需求

### 在动手设计前，反复思考，真正编码的时间只有5%

* 基础架构、对象存储的开发；设计的时间多的多，真正编码的时间很少
* 会在设计层面反复推演，写伪代码
* 想的不清不楚，就写代码，就是给自己挖坑
* 一个好的架构图，应该在信封上能画出来

## 架构设计

### 概览

![评论系统-架构](https://i.loli.net/2021/11/05/RUuDt8HA9aKGBhC.png)

### BFF: comment

* 复杂评论业务的服务编排，比如访问账号服务进行等级判定，同时需要在BFF面向移动端/WEB场景来设计API，这一层抽象把评论的本省的内容列表处理（加载、分页、排序等）进行了隔离，关注在业务平台化逻辑上。